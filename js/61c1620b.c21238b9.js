(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["61c1620b"],{"47b2":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"iv-page"},[a("TitleBar",{attrs:{titleTx:t.title}}),a("span",{staticClass:"iv-tt-gray",staticStyle:{color:"black"}},[t._v("快捷买入:")]),a("div",{staticStyle:{"margin-top":"10px"}},[a("q-btn",{staticStyle:{color:"goldenrod","margin-left":"10px"},attrs:{outline:"",label:"1 ETH"},on:{click:function(e){t.buy("1")}}}),a("q-btn",{staticStyle:{color:"goldenrod","margin-left":"10px"},attrs:{outline:"",label:"2 ETH"},on:{click:function(e){t.buy("2")}}}),a("q-btn",{staticStyle:{color:"goldenrod","margin-left":"10px"},attrs:{outline:"",label:"5 ETH"},on:{click:function(e){t.buy("5")}}}),a("q-btn",{staticStyle:{color:"goldenrod","margin-left":"10px"},attrs:{outline:"",label:"10 ETH"},on:{click:function(e){t.buy("10")}}})],1),a("span",{staticClass:"iv-tt-gray",staticStyle:{color:"black","margin-top":"10px"}},[t._v("或自定义金额:")]),a("q-input",{staticClass:"in-in-ma",attrs:{"float-label":"投入金额ETH",type:"number"},model:{value:t.toAmt,callback:function(e){t.toAmt=e},expression:"toAmt"}}),a("span",{staticClass:"iv-tt-gray"},[t._v("需要消耗:"+t._s(.01*t.toAmt/t.global.mcoinPrice)+" OK0X")]),a("q-btn",{staticClass:"btn-next",attrs:{label:"买入",color:"primary"},on:{click:t.toNext}}),a("span",{staticClass:"iv-tt-gray",staticStyle:{color:"dodgerblue"},on:{click:t.toInvestReadme}},[a("u",[t._v("查看公告")])])],1)},n=[];i._withStripped=!0;a("6b54");var s=a("9bfb"),o=a("e7ea"),l=a("a002"),c=a.n(l),r=a("96a1"),h=a("3452"),u={components:{TitleBar:s["a"]},data:function(){return{currentBalance:this.global.wallet.lastEthbalance,title:"买入",toAddress:"",toAmt:"",canInvest:!0,investBmobId:"",investAmt:""}},mounted:function(){var t=this;if("true"===this.global.investDistrice24){var e={address:this.global.wallet.ethAddress};this.$axios.get(this.global.BmobRestAPIUrl+"invest?where="+encodeURI(JSON.stringify(e)),{headers:this.global.BmobRestAPIHeaders}).then(function(e){if(200===e.status){var a=e.data.results;0!==a.length&&(t.investBmobId=a[0].objectId,t.canInvest=(new Date).getTime()-a[0].time>=864e5)}})}},methods:{toInvestReadme:function(){this.$router.push("/withdrawreadme")},bmobAddOrUpdate:function(){""===this.investBmobId?this.addAInvest():this.updateInvestTime(this.investBmobId)},updateInvestTime:function(t){this.$axios.put(this.global.BmobRestAPIUrl+"invest/"+t,{time:(new Date).getTime()+""},{headers:this.global.BmobRestAPIHeaders}).then(function(t){})},addAInvest:function(){this.$axios.post(this.global.BmobRestAPIUrl+"invest",{address:this.global.wallet.ethAddress,time:(new Date).getTime()+""},{headers:this.global.BmobRestAPIHeaders}).then(function(t){})},toNext:function(){var t=this,e=this;this.canInvest?this.toAmt>=this.global.minPerInvest&&this.toAmt<=this.global.config.maxPerInvest?this.toAmt>this.global.wallet.lastEthbalance?toast("你的ETH余额不足，请先转入足量ETH"):(this.global.wallet.lastEthbalance-this.toAmt<.001&&toast("请预留足够的矿工费(例如：0.001eth)，否则可能买入失败"),.01*this.toAmt/this.global.mcoinPrice>this.global.wallet.lastMcoinBalance?this.$q.dialog({title:"",message:"OK0X余额不足，请先购买相应数量的OK0X"}).then(function(){e.$router.push({path:"/ethtransfer",query:{p1:"OK0X",p2:t.global.wallet.lastMcoinBalance}})}).catch(function(){}):(this.investAmt=this.toAmt,this.showPswdInputDialog())):toast("单笔买入金额最少"+this.global.minPerInvest+"ETH,最多"+this.global.config.maxPerInvest+"ETH"):toast("同一账户24小时只能投资一次哦")},buy:function(t){var e=this;t>this.global.wallet.lastEthbalance?toast("你的ETH余额不足，请先转入足量ETH"):(this.global.wallet.lastEthbalance-t<.001&&toast("请预留足够的矿工费(例如：0.001eth)，否则可能买入失败"),.01*t/this.global.mcoinPrice>this.global.wallet.lastMcoinBalance?this.$q.dialog({title:"",message:"OK0X余额不足，请先购买相应数量的OK0X"}).then(function(){_this.$router.push({path:"/ethtransfer",query:{p1:"OK0X",p2:e.global.wallet.lastMcoinBalance}})}).catch(function(){}):(this.investAmt=t,this.showPswdInputDialog()))},showPswdInputDialog:function(){var t=this;this.$q.dialog({title:this.itmeName1,message:"请输入你的钱包密码",prompt:{model:"",type:"text"},cancel:!0,color:"secondary"}).then(function(e){""===e?toast("密码不能为空哦"):(t.$q.loading.show({message:"正在提交交易，请稍后...",spinnerSize:50}),c.a.getItem("cryptMnemonic").then(function(a){null===a?(t.$q.loading.hide(),toast("当前没有可备份钱包，将跳到创建钱包页面"),t.$router.push("/walletfirst")):t.unlockWallet(a,e)}).catch(function(t){toast(t)}))}).catch(function(){})},unlockWallet:function(t,e){try{var a=h.AES.decrypt(t,e),i=a.toString(h.enc.Utf8),n=o["ethers"].Wallet.fromMnemonic(i),s=n.connect(this.global.defaultProvider);this.doInvest(s)}catch(t){console.log(t),toast("密码错误"),this.$q.loading.hide()}},doInvest:function(t){var e=this,a=this.global.m3gameContract.connect(t),i={value:o["ethers"].utils.parseEther(this.investAmt+"")};a.inverstOnce(i).then(function(t){console.log(t),e.$q.loading.hide(),e.showInfoDialog("已提交",t.hash),e.listen4InvestResult(t.hash)}).catch(function(t){e.global.reprotError2Bmob(e,"inverstAgain",t),e.$q.loading.hide()})},listen4InvestResult:function(t){var e=this;this.global.defaultProvider.once(t,function(t){console.log("----Transaction Minded:----"),console.log(t),1===t.status?(toast("投资成功"),e.bmobAddOrUpdate()):toast("投资失败，请重试")})},showInfoDialog:function(t,e){var a=this;this.$q.dialog({title:t,message:"",ok:"查看结果",cancel:"关闭"}).then(function(){a.$router.go(-1),Object(r["a"])(a.global.etherscanio+"tx/"+e)}).catch(function(){a.$router.go(-1)})}}},d=u,b=(a("ea97"),a("2877")),g=Object(b["a"])(d,i,n,!1,null,null,null);g.options.__file="Invest.vue";e["default"]=g.exports},"6fd7":function(t,e,a){},"9bfb":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-bar"},[a("q-icon",{staticClass:"title-back-icon",attrs:{name:"navigate_before"},nativeOn:{click:function(e){return t.goBack(e)}}}),a("div",{staticClass:"title-tx"},[t._v(t._s(t.titleTx))])],1)},n=[];i._withStripped=!0;var s={props:["titleTx"],methods:{goBack:function(){this.$router.go(-1)}}},o=s,l=(a("a675"),a("2877")),c=Object(l["a"])(o,i,n,!1,null,null,null);c.options.__file="TitleBar.vue";e["a"]=c.exports},a675:function(t,e,a){"use strict";var i=a("ca51"),n=a.n(i);n.a},ca51:function(t,e,a){},ea97:function(t,e,a){"use strict";var i=a("6fd7"),n=a.n(i);n.a}}]);